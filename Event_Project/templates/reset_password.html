<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create New Password | EventPro</title>
    <link rel="stylesheet" href="reset.css">
</head>
<body>

    <div class="main-container">
        <div class="card">
            {% if validlink %}
                <div class="header">
                    <h1>Set New Password</h1>
                    <p>Identity verified. Please enter your new secure password.</p>
                </div>

                <form method="POST" class="verification-form">
                    {% csrf_token %}
                    
                    <div class="django-form-wrapper">
                        {{ form.as_p }}
                        {% if form.errors %}
                            <div style="color: red;">
                                <ul>
                                    {% for field in form %}
                                        {% for error in field.errors %}
                                            <li>{{ field.label }}: {{ error }}</li>
                                        {% endfor %}
                                    {% endfor %}
                                    {% for error in form.non_field_errors %}
                                        <li>{{ error }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        {% endif %}
                    </div>
                    <button type="submit" class="submit-btn update-btn">
                        Update Database & Login
                    </button>
                </form>
            {% else %}
                <div class="header error-state">
                    <div class="icon">⚠️</div>
                    <h1>Link Expired</h1>
                    <p>This security token is no longer valid. Please request a new link.</p>
                    <a href="{% url 'reset_password' %}" class="submit-btn secondary">Go Back</a>
                </div>
            {% endif %}
        </div>
    </div>

</body>
</html>